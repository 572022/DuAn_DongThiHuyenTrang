
@{
    ViewBag.Title = "detail";
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
}
@model WebMULTI.Models.Procom
@using PagedList.Mvc;
@*@model PagedList.PagedList<WebMULTI.Models.Procom>*@
<head>
    <meta charset="utf-8">
    <title>MultiShop - Online Shop Website Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="~/img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="~/lib/animate/animate.min.css" rel="stylesheet">
    <link href="~/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->

    <link href="~/css/style.css" rel="stylesheet" />

    <style>
        body {
            font-family: 'SVN-Product Sans', sans-serif;
            font-size: 16px;
        }

        .comment-box {
            padding: 5px
        }

        .comment-area textarea {
            resize: none;
            width: auto;
        }

        .form-control:focus {
            color: black;
            background-color: #fff;
            border-color: #ffffff;
            outline: 0;
            box-shadow: 0 0 0 1px rgb(255, 0, 0) !important
        }

        .send {
            color: #fff;
            background-color: #ff0000;
            border-color: #ff0000
        }

            .send:hover {
                color: #fff;
                background-color: #f50202;
                border-color: #f50202
            }

        .rating {
            display: inline-flex;
            margin-top: -10px;
            flex-direction: row-reverse;
        }

            .rating > input {
                display: none
            }

            .rating > label {
                position: relative;
                width: 20px;
                font-size: 27px;
                color: #ffbb00;
                cursor: pointer;
            }

                .rating > label::before {
                    content: "\2605";
                    position: absolute;
                    opacity: 0
                }

                .rating > label:hover:before,
                .rating > label:hover ~ label:before {
                    opacity: 1 !important
                }

            .rating > input:checked ~ label:before {
                opacity: 1
            }

            .rating:hover > input:checked ~ label:before {
                opacity: 0.4
            }

        .star-filled {
            color: #ffbb00; /* Đổi màu sao thành màu vàng */
        }

        .comments-container {
            display: flex;
            justify-content: space-between;
        }

        .comments-column {
            flex: 1;
            padding: 10px;
        }

        .comment {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            overflow: auto;
            height: 175px; /* Thay đổi giá trị này thành chiều cao mong muốn */
            position: relative; /* Để sử dụng absolute positioning cho ngày và username */
        }
        /* Định dạng cho ngày (bên phải) */
        .comment-date {
            position: absolute;
            top: 15px;
            right: 10px; /* Khoảng cách từ bên phải */
        }

        .d-flex {
            display: flex !important;
            margin-top: 5px;
        }

        .button-buy a {
            font-size: 14px;
        }

        #close-cart {
            font-size: 2.5rem;
            cursor: pointer;
        }

        .cart-title h4 {
            font-size: 22px;
        }

        #delete_product {
            font-size: 2.5rem;
        }

        select {
            word-wrap: normal;
            width: 130px;
            padding: 5px 10px;
        }

        * {
            box-sizing: border-box;
        }

        .row > .column {
            padding: 0 8px;
        }

        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        .column {
            float: left;
            width: 25%;
        }

        /* The Modal (background) */
        .modal1 {
            display: block;
            z-index: 1;
            /*padding-top: 100px;*/
            /* left: 0;
            top: 0;*/
            width: auto;
            /*height: 100%;
            overflow: auto;*/
        }

        /* Modal Content */
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: auto;
            padding: 0;
            width: 90%;
            max-width: 1000px;
        }

        /* The Close Button */
        .close:hover,
        .close:focus {
            color: #999;
            text-decoration: none;
            cursor: pointer;
        }

        .mySlides {
            display: none;
        }

        .cursor {
            cursor: pointer;
        }

        /* Next & previous buttons */
        .prev,
        .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Position the "next button" to the right */
        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }
            /* On hover, add a black background color with a little bit see-through */
            .prev:hover,
            .next:hover {
                background-color: rgba(0, 0, 0, 0.8);
            }

        img {
            margin-bottom: -4px;
        }


        .demo {
            opacity: 0.6;
        }

            .active,
            .demo:hover {
                opacity: 1;
            }

        img.hover-shadow {
            transition: 0.3s;
        }

        .hover-shadow:hover {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }
    </style>
</head>
<!-- Breadcrumb Start -->
<div class="container-fluid">
    <div class="row px-xl-5">
        <div class="col-12">
            <nav class="breadcrumb bg-light mb-30">
                <a class="breadcrumb-item text-dark" href="#">Home</a>
                <span class="breadcrumb-item active">Shop Detail</span>
            </nav>
        </div>
    </div>
</div>
<!-- Breadcrumb End -->
<!-- Shop chi tiết Start -->

<div class="container-fluid pb-5">
    <div class="row px-xl-5">
        <div class="col-lg-5 mb-30">
            <div id="myModal" class="modal1">
                <div class="modal-content">
                    @Html.Action("partialImg", "Home", new { masp = @Model.procductDetails.ProductId })
                    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                    <a class="next" onclick="plusSlides(1)">&#10095;</a>

                </div>
            </div>
        </div>
        @*sao đánh giá*@
        <div class="col-lg-7 h-auto mb-30">
            <div class="h-100 bg-light p-30">
                <h3>@Model.procductDetails.SanPham.TenSP</h3>
                <div class="d-flex mb-3">
                    <div class="text-primary mr-2">
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star-half-alt"></small>
                        <small class="far fa-star"></small>
                    </div>
                    <small class="pt-1">(99 Reviews)</small>
                </div>
                <h3 class="font-weight-semi-bold mb-4">@Html.FormatValue(@Model.procductDetails.SanPham.GiaSP, "{0:#,##0}") VNĐ</h3>
                @*size*@
                <div class="d-flex mb-3">
                    <strong class="text-dark mr-3">Sizes:</strong>
                    <form>
                        <div class="custom-control custom-radio custom-control-inline">

                            <label>Over size</label>
                        </div>

                    </form>
                </div>
                @*color*@
                @*@Html.Action("pro_color", "Home")*@

                @using (Html.BeginForm("ThemGioHang1", "Cart", new { ms = Model.procductDetails.SanPham.MaSP, url = Request.Url.ToString() }, FormMethod.Post, new { id = "colorForm" }))
                {
                    <!--<-->@*form*@ <!--action="ThemGioHang1/Cart" id = "colorForm" method="post">-->
                    <span>Color:</span> @Html.DropDownList("MaCD", ViewBag.MaCD as SelectList)

                    <div class="d-flex align-items-center mb-4 pt-2">

                        <div class="input-group quantity mr-3" style="width: 140px;">
                            <div class="input-group-btn">
                                <button class="btn btn-primary btn-minus">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </div>

                            <input class="btn " id="quantityInput" name="iSoLuong" min="1" value="1" type="number" style="width: 60px;" />
                            <div class="input-group-btn">
                                <button class="btn btn-primary btn-plus">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-primary px-3" id="addToCartButton">
                            <i class="fa fa-shopping-cart mr-1"></i> Add To
                            Cart
                        </button>
                        @Html.HiddenFor(model => model.procductDetails.MaSP, new { name = "ms" })

                    </div>

                }
                @*share*@
                <div class="d-flex pt-2">
                    <strong class="text-dark mr-2">Share on:</strong>
                    <div class="d-inline-flex">
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-pinterest"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row px-xl-5">
        <div class="col">
            <div class="bg-light p-30">
                <div class="nav nav-tabs mb-4">
                    <a class="nav-item nav-link text-dark active" data-toggle="tab" href="#tab-pane-1">Mô tả</a>
                    <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-2">Hướng dẫn chọn size</a>
                    <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-3">Bình luận đánh giá </a>
                </div>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="tab-pane-1">
                        @*<h4 class="mb-3">Mô tả sản phẩm</h4>*@
                        <p>@Html.Raw(@Model.procductDetails.SanPham.Mota)</p>
                    </div>
                    <div class="tab-pane fade" id="tab-pane-2">
                        @*<h4 class="mb-3">Hướng dẫn chọn size</h4>*@
                        <img src="~/img/tablesize.jpg" />
                    </div>
                    <div class="tab-pane fade" id="tab-pane-3">
                        <div class="row">
                            <div class="col-md-5">
                                <div class="comments-container">

                                    <div class="comments-column comments-column1">
                                        @foreach (var binhLuan in Model.Comments.Skip(Model.Comments.Count / 2))
                                        {
                                            <div class="comment">
                                                <h4>@binhLuan.Username</h4>
                                                <p class="comment-date">@Html.FormatValue(binhLuan.NgayBL, "{0:dd/MM/yyyy}")</p>
                                                @if (int.TryParse(binhLuan.Danhgia, out int danhGiaInt))
                                                {
                                                    <div class="fas rating">
                                                        @for (int i = 5; i >= 1; i--)
                                                        {
                                                            <i class="fa-solid @(i <= danhGiaInt ? "fa-star star-filled" : "fa-star far")"></i>
                                                        }
                                                    </div>
                                                }
                                                <span>( @binhLuan.Danhgia / 5 )</span>
                                                <p class="comment-content">@binhLuan.Noidung</p>
                                            </div>
                                        }
                                    </div>
                                </div><!-- end row -->
                                @Html.PagedListPager(Model.Comments, page => Url.Action("detail", new { id = Model.procductDetails.SanPham.MaSP, page }), new PagedListRenderOptions { Display = PagedListDisplayMode.IfNeeded, MaximumPageNumbersToDisplay = 5 })

                            </div>
                            @*Phần bình luận*@
                        <div class="col-md-7">
                            <h3>Thêm đánh giá</h3>
                            <div class="container">
                              
                                <div class="col-md-6">
                                    @if (Session["Username"] != null)
                                    {
                                        if (!ViewBag.HasComment)
                                        {
                                            using (Html.BeginForm("AddComment", "Home"))
                                            {
                                                @Html.Hidden("productId", Model.procductDetails.SanPham.MaSP)
                                                <div class="comment-box">
                                                    <div>
                                                        <label for="rating">Đánh giá của bạn <span style="color:red">*</span>: &nbsp;&nbsp;&nbsp;</label>
                                                        <div class="rating">
                                                            <input type="radio" name="Rating" id="5" value="5"><label for="5">☆</label>
                                                            <input type="radio" name="Rating" id="4" value="4"><label for="4">☆</label>
                                                            <input type="radio" name="Rating" id="3" value="3"><label for="3">☆</label>
                                                            <input type="radio" name="Rating" id="2" value="2"><label for="2">☆</label>
                                                            <input type="radio" name="Rating" id="1" value="1"><label for="1">☆</label>
                                                        </div>
                                                    </div>
                                                    <p><label for="comment">Nhận xét của bạn <span style="color:red">*</span>:</label> </p>
                                                    <div class="comment-area">
                                                        <textarea name="comment" id="comment" rows="4" cols="80" required></textarea>
                                                    </div>
                                                    <br />
                                                    <div class="mt-4">
                                                        <button class="btn btn-success send px-5" type="submit">Gửi đi</button>
                                                    </div>
                                                </div>
                                            }
                                        }
                                        else
                                        {
                                            <p style="font-style:italic; font-weight:bold">Bạn đã bình luận về sản phẩm này rồi.</p>
                                        }
                                    }
                                    else
                                    {
                                        <p style="font-style:italic; font-weight:bold">
                                            Để bình luận, đánh giá bạn cần phải đăng nhập
                                            <a href="@Url.Action("LogIn", "Account")" class="txt2">Đăng nhập</a>
                                        </p>

                                    }
                                </div>
                            </div><!-- end container -->
                            <!-- end container -->

                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Shop Detail End -->
<!--có thể bạn sẽ thích Products Start -->
<h4>Các sản phẩm tương tự</h4>
@Html.Action("Maybeyoulike", "Home")
<!-- Products End -->
<!-- Back to Top -->
<a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>

<script>
</script>
<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="~/lib/easing/easing.min.js"></script>
<script src="~/lib/owlcarousel/owl.carousel.min.js"></script>



<!-- Template Javascript -->


<script>
    function openModal() {
        document.getElementById("myModal").style.display = "block";
    }

    function closeModal() {
        document.getElementById("myModal").style.display = "none";
    }

    var slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    function currentSlide(n) {
        showSlides(slideIndex = n);
    }

    function showSlides(n) {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        var dots = document.getElementsByClassName("demo");
        var captionText = document.getElementById("caption");
        if (n > slides.length) { slideIndex = 1 }
        if (n < 1) { slideIndex = slides.length }
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(" active", "");
        }
        slides[slideIndex - 1].style.display = "block";
        dots[slideIndex - 1].className += " active";
        captionText.innerHTML = dots[slideIndex - 1].alt;
    }

    //bình luận
    //Phân trang
$(document).ready(function () {
    // Số lượng bình luận trên mỗi trang
    var pageSize = 2;

    // Số lượng trang cho cả hai cột
    var pageCount = Math.ceil(@Model.Comments.Count / 2 / pageSize);

    // Kích hoạt phân trang cho cả hai cột
    function activatePagination(columnId) {
        $("#" + columnId).pagination({
            dataSource: new Array(pageCount),
            pageSize: pageSize,
            callback: function (data, pagination) {
                $("#" + columnId + " .comment").hide();
                for (var i = data[0] * pageSize; i < (data[0] + 1) * pageSize; i++) {
                    $("#" + columnId + " .comment").eq(i).show();
                }
            }
        });
    }

    activatePagination("comments-column1");
    activatePagination("comments-column2");
});
</script>